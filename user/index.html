<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com"><!--ブラウザが Google Fonts のサーバーに早めに接続するように指示する-->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><!--Google Fontsが別のサーバー (gstatic.com) からフォントのデータを取得する-->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet"><!--ここで Noto Sans JP フォントを実際に読み込みます-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js" defer></script>
    <title>肉体改造管理システム</title>
</head>
<body id="home">
    <div class="sidebar">
    <!-- 今日の日付 -->
    <p id="today"></p>
   
    <div id="username"></div>
   
    <!-- 身長と体重の入力 -->
<p><label for="user_height">身長</label><input type="number" id="user_height" placeholder="例: 160" min="0" max="999" step="1"></p>
<p><label for="user_weight">体重</label><input type="number" id="user_weight" placeholder="例: 55" min="0" max="1000" step="0.1"></p>
<p><label for="moku">目標<br></label><input type="text" id="moku"placeholder="目標"></p>

<!--~~~~~~~~~入力欄の中のcm,kgを表示させるための部分~~~~~~~~~~-->
<div class="cm">
    <p>cm</p>
</div>

<div class="kg">
    <p>kg</p>
</div>
<!--~~~~~~~~~入力欄の中のやつ終わり~~~~~~~~~~~-->
<!-- BMI計算ボタン -->
<p>BMI: <span id="result"></span></p>
<p><button id="con" class="custom-button con" onclick="calculateBMI();saveData();">確定</button></p>

<!-- 平均値表示 -->
<h2>平均</h2>
<p>体重: <span id="heitai"></span> kg</p>
<p>BMI: <span id="heibmi"></span>%</p>
    </div>

    <div class="content">
     <!-- トレーニングリストを表示するためのスクロール可能なエリア -->
<div class="scrollable-memo" id="exerciseList">
  <!-- ローカルストレージから読み込んだトレーニングリストがここに表示されます -->
</div>


<button  class="logout" onclick="location.href='../kakunin/login.html';"></button>


    <!-- 目標入力 -->
    <div id="mokuhyou"></div>

 
    <div class="picto">
      <!-- 人型ピクトグラム -->
      <svg id="body-parts" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 250" width="400" height="600">
        <!-- 頭 -->
        <circle cx="60" cy="40" r="20" class="body-part" id="head" />
        <!-- 胸筋 -->
        <rect x="45" y="60" width="30" height="40" class="body-part" id="chest" />
        <!-- 腹筋 -->
        <rect x="45" y="100" width="30" height="50" class="body-part" id="abs" />
        <!-- 左腕 (反対方向に広げる) -->
        <rect x="30" y="70" width="10" height="60" class="body-part arms" id="arms" transform="rotate(30 35 83)" />
        <!-- 右腕 (反対方向に広げる) -->
        <rect x="80" y="70" width="10" height="60" class="body-part arms" id="arms" transform="rotate(-30 85 83)" />
        <!-- 左脚 (斜めに広げる) -->
        <rect x="38" y="150" width="10" height="80" class="body-part legs" id="legs" transform="rotate(15 45 150)" />
        <!-- 右脚 (斜めに広げる - 線対称に配置) -->
        <rect x="68" y="150" width="10" height="80" class="body-part legs" id="legs" transform="rotate(-15 72 142)" />
    </svg>
    </div>
 
 
    <!-- 各種ボタンとグラフ表示 -->
    <p>
        <div class="button-container">
            <button id="care" class="care" onclick="location.href='../sample/after_care.html'; ">アフターケア</button>
            <button id="tr" class="tr" onclick="torepage() ">トレーニング追加</button>
          </div>
       <h1>体重管理</h1>
        <div id="taijyu">
          <button id="days" class=" days" onclick="days_id()">日間</button>
          <button id="week" class=" week" onclick="week_id()">週間</button>
          <button id="history" class=" history" onclick="kakopage()">過去記録</button>
          </div>
        <canvas id="lineChart"></canvas>
    </p>
 
    <div class="food-input">
      <textarea id="text-breakfast" placeholder="入力してください"></textarea>
      <textarea id="text-lunch" placeholder="入力してください"></textarea>
      <textarea id="text-dinner" placeholder="入力してください"></textarea>
    </div>
   
      <script>
        // ページが読み込まれたときにローカルストレージからデータを取得
        // ページロード時の処理
window.onload = async function () {
    const urlParams = new URLSearchParams(window.location.search);
    const userId = Number(urlParams.get('userId')); // userIdを数値として取得
    console.log('取得したuserId:', userId); // ここでuserIdを確認
    await loadWeightData(); // データベースから体重データをロード
    await loadAndDisplayuserName(userId);
    await loadAndDisplayMokuhyou(userId);
    await loadAndDisplayFood(userId);
    GetFood();
    addTodayHistory(userId);
    initCreateData(userId);
    transferFoodIdToHistory(userId);
    transferTorehisIdToHistory(userId);



  //ここ二つロード時やらせる
// function fetchUsers() {
//     return fetch('https://karadanipi-su-api.onrender.com/users')
//       .then(response => {
//         if (!response.ok) {
//           throw new Error('ネットワークのエラーが発生しました');
//         }
//         return response.json();
//       })
//       .then(data => {
//         data.forEach(user => {
//           UserData[user.userid] = user.username, user.mokuhyou, user.height, user.weight; // ユーザーIDをキーにusernameを保存
//         });
//       })
//       .catch(error => {
//         console.error('ユーザーデータ取得エラー:', error);
//         alert('ユーザーデータの取得に失敗しました');
//       });
//   }
        };
  </script>
 
    
 
     <!--登録ボタン-->
      <div id="submit"> <!--登録ボタンをCSSでいじるためのID[submit]-->
          <input type="submit"  onclick=" saveFoodData();saveFood();" value="登録">
      </div>
             
      <div class="goha">
            <button id="breakfast" class="breakfast" onclick="breakfastpage();" >朝食</button>
            <button id="lunch" class="lunch" onclick="lunchpage();">昼食</button>
            <button id="dinner" class="dinner" onclick="dinnerpage();">夜食</button>
          </div>
 
</body>
</html>